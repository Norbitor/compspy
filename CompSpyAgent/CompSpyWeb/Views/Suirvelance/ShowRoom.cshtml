@model IEnumerable<CompSpyWeb.Models.Computer>
@{
    ViewBag.Title = "Podgląd sali";
}

<h2>@ViewBag.Title</h2>

<div class="row">
    @foreach(var computer in Model)
    { 
        <div class="col-md-4" id="@computer.StationDiscriminant">
            <h3>@computer.StationDiscriminant</h3>
            
            @if (computer.ConnectionID != null)
            {
                <a href="@Url.Action("ShowComputer", "Suirvelance", new { id = computer.ComputerID })"><img src="~/Pics/no_connection.png" /></a><br />
                <p class="label label-success">Połączone</p>
            }
            else
            {
                <img src="~/Pics/no_connection.png" /><br />
                <p class="label label-warning">Brak połączenia</p>
            }
        </div>
    }
</div>

@section scripts {
    <script src="~/Scripts/jquery.signalR-2.2.1.min.js"></script>
    <script src="~/signalr/hubs"></script>

    <script>
        $(function () {
            var hub = $.connection.suirvelanceHub;

            $.connection.hub.start().done(function () {
                hub.server.connect("@ViewBag.ClassroomName");
            });

            window.onbeforeunload = function (e) {
                hub.server.disconnect("@ViewBag.ClassroomName");
                $.connection.hub.stop();
            }
        });
    </script>
}
